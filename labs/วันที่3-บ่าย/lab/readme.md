# คู่มือการสร้างแผนที่ใน Power BI สำหรับข้อมูลประเทศไทย

คู่มือนี้อธิบายวิธีการสร้างแผนที่ประเภทต่างๆ ใน Power BI สำหรับการวิเคราะห์ข้อมูลเชิงพื้นที่ของประเทศไทย

## การตั้งค่าการใช้งาน Map และ Filled Map ใน Power BI

ก่อนเริ่มใช้งานแผนที่ใน Power BI ควรตรวจสอบและตั้งค่าการใช้งานแผนที่ให้เหมาะสม:

1. **เปิดการตั้งค่า Map และ Filled Map:**
   * ไปที่ "File" > "Options and settings" > "Options"
   * เลือก "GLOBAL" ด้านซ้าย 
   * เลื่อนลงไปที่ "Map and Filled Map visuals"
   * ทำเครื่องหมายที่ช่อง "Use Map and Filled Map visuals"

2. **ตั้งค่าความปลอดภัย:**
   * ภายใต้หัวข้อ "Security" ให้เลือกระดับการตรวจสอบที่เหมาะสม
   * แนะนำให้เลือก "Basic check" หรือ "Comprehensive check"

3. **การตั้งค่า Data Extensions:**
   * เลือก "(Recommended) Only allow Microsoft-certified and other trusted third-party extensions to load"
   * ตรวจสอบว่ามีการเตือนเมื่อเพิ่ม custom visual (Show security warning when adding a custom visual to a report)

4. **การตั้งค่า ArcGIS for Power BI (ตัวเลือกเสริม):**
   * หากต้องการใช้ ArcGIS ที่มีฟีเจอร์เพิ่มเติม ให้ทำเครื่องหมายที่ "Use ArcGIS for Power BI"

5. **ระดับการเตือนการแสดงตัวอย่างเว็บ:**
   * ตั้งค่า "Web Preview Warning Level" เป็น "Moderate" หรือระดับที่ต้องการ

หลังจากตั้งค่าเรียบร้อยแล้ว คลิก "OK" เพื่อบันทึกการตั้งค่า และเริ่มใช้งานแผนที่ใน Power BI ได้ทันที

## คู่มือการสร้าง Filled Map แสดง GDP ตามจังหวัดของประเทศไทย

คู่มือนี้จะอธิบายวิธีการสร้าง Filled Map แสดงข้อมูล GDP ตามจังหวัดของประเทศไทย ตามตัวอย่างในภาพที่แสดง

### 1. การเตรียมข้อมูล

1. **เตรียมข้อมูลที่มีฟิลด์สำคัญ:**
   * ชื่อจังหวัดภาษาอังกฤษ (Province)
   * ข้อมูล GDP (GDP_Million_Baht)
   * ข้อมูลอื่นๆ ที่อาจต้องการแสดงเพิ่มเติม เช่น Population, Region, TouristVisits

2. **นำเข้าข้อมูลใน Power BI:**
   * คลิก "Get Data" และเลือกแหล่งข้อมูล (Excel, CSV, Database)
   * เลือกและโหลดตารางข้อมูลจังหวัดที่มีชื่อภาษาอังกฤษและข้อมูล GDP

### 2. การสร้าง Filled Map

1. **เลือกวิชวล Filled Map:**
   * คลิกที่พื้นที่ว่างในรายงาน Power BI
   * ไปที่แผง Visualizations ด้านขวา
   * เลือกไอคอน Filled Map (แสดงเป็นแผนที่ที่มีการระบายสี)

2. **กำหนดฟิลด์ข้อมูล:**
   * ลาก "Province" ไปยังช่อง "Location"
   * ลาก "GDP_Million_Baht" ไปยังช่อง "Legend" หรือ "Color saturation"

3. **รอให้ Power BI ทำการประมวลผล:**
   * ระบบจะพยายามจับคู่ชื่อจังหวัดกับข้อมูลแผนที่
   * จะแสดงแผนที่ประเทศไทยโดยมีสีแตกต่างกันตามค่า GDP ของแต่ละจังหวัด

### 3. การปรับแต่งการแสดงผล

1. **ตั้งชื่อวิชวล:**
   * ดับเบิลคลิกที่ชื่อวิชวลด้านบน (เดิมคือ "Province and GDP_Million_Baht")
   * แก้ไขเป็นชื่อที่ต้องการ เช่น "GDP รายจังหวัดของประเทศไทย (ล้านบาท)"

2. **ปรับแต่งสี:**
   * คลิกที่ไอคอนรูปแปรงสี (Format your visual)
   * ไปที่ "Data colors"
   * เลือกชุดสีที่ต้องการ (จากภาพใช้โทนสีหลากหลาย)
   * ปรับความเข้มหรือชุดสีตามต้องการ

3. **ปรับแต่ง Legend:**
   * ในส่วน Format > Legend
   * ปรับตำแหน่ง (Position) เป็น Top, Bottom, Left หรือ Right ตามต้องการ
   * ปรับขนาดตัวอักษรและสไตล์

4. **ปรับระดับการซูม:**
   * ในส่วน Format > Map
   * ปิดการตั้งค่า "Auto zoom" (ถ้ามี)
   * ใช้ปุ่ม + และ - บนแผนที่เพื่อปรับระดับการซูม
   * เลื่อนแผนที่โดยการคลิกและลากให้ประเทศไทยอยู่ตรงกลาง
   * กำหนด Zoom level ที่เหมาะสม (ประมาณ 5-7 สำหรับประเทศไทย)

### 4. การเพิ่มประสิทธิภาพการแสดงผล

1. **เพิ่ม Tooltips:**
   * ลากฟิลด์อื่นๆ เช่น Population, Region, TouristVisits ไปยังช่อง "Tooltips"
   * เมื่อผู้ใช้เลื่อนเมาส์ไปบนจังหวัด จะเห็นข้อมูลเพิ่มเติม

2. **สร้างการกรองข้อมูล:**
   * เพิ่ม Slicer โดยใช้ฟิลด์ Region
   * ผู้ใช้จะสามารถกรองดูเฉพาะภูมิภาคที่ต้องการได้

3. **การเชื่อมโยงกับวิชวลอื่น:**
   * สร้าง Bar chart หรือ Table เพื่อแสดงข้อมูลในรูปแบบอื่น
   * ตั้งค่า Interaction ให้การคลิกเลือกจังหวัดบนแผนที่ส่งผลต่อวิชวลอื่นด้วย

### 5. การแก้ไขปัญหาที่อาจพบ

1. **บางจังหวัดไม่แสดงบนแผนที่:**
   * ตรวจสอบการสะกดชื่อจังหวัดภาษาอังกฤษให้ถูกต้อง
   * ตรวจสอบว่าคอลัมน์ Province มีการตั้งค่า Data Category เป็น "Place" หรือ "City"

2. **แผนที่แสดงขอบเขตไม่ครบถ้วน:**
   * ปรับระดับการซูมให้เหมาะสม
   * ตรวจสอบว่าทุกจังหวัดมีการแม็ปข้อมูลอย่างถูกต้อง

3. **สีไม่แสดงความแตกต่างอย่างชัดเจน:**
   * ปรับชุดสีหรือช่วงค่าสี
   * พิจารณาการแบ่งช่วงข้อมูล GDP เป็นกลุ่มเพื่อให้เห็นความแตกต่างชัดเจนขึ้น

### 6. การบันทึกและแชร์

1. **บันทึกรายงาน:**
   * คลิกที่ "File" > "Save" หรือ "Save As"
   * ตั้งชื่อรายงานที่สื่อความหมาย

2. **การแชร์:**
   * อัปโหลดรายงานไปยัง Power BI Service (ถ้ามีสิทธิ์)
   * แชร์ลิงก์หรือฝังรายงานในเว็บไซต์หรือแอปพลิเคชันอื่น

### 7. เทคนิคเพิ่มเติม

1. **เพิ่มจุดเด่นให้จังหวัดที่มี GDP สูง:**
   * สร้าง Measure ใหม่ที่ไฮไลท์จังหวัดที่มี GDP สูงกว่าค่าเฉลี่ย
   * ใช้สัญลักษณ์หรือป้ายกำกับพิเศษ

2. **การเปรียบเทียบข้อมูลหลายปี:**
   * หากมีข้อมูล GDP หลายปี สร้าง Timeline slicer เพื่อให้ผู้ใช้เลือกดูข้อมูลตามปีที่ต้องการ

ด้วยขั้นตอนเหล่านี้ คุณจะสามารถสร้าง Filled Map แสดงข้อมูล GDP ตามจังหวัดของประเทศไทยได้อย่างมีประสิทธิภาพตามตัวอย่างในภาพ

---

## ขั้นตอนการสร้าง Bubble Map ตามรูปภาพ

### 1. การเตรียมข้อมูลและเลือกวิชวล

1. นำเข้าข้อมูลตาราง bubble_map ที่มีฟิลด์ Latitude, Longitude, Province, TouristVisits และอื่นๆ
2. เลือกวิชวล "Map" (ไอคอนรูปหมุดปักแผนที่) จากแผง Visualizations

### 2. การตั้งค่าฟิลด์สำหรับแผนที่

1. ลาก "Latitude" ไปยังช่อง "Latitude"
2. ลาก "Longitude" ไปยังช่อง "Longitude"
3. ลาก "TouristVisits" ไปยังช่อง "Bubble size" (หรือในรูปแสดงเป็น "Size")
   * สังเกตว่าในรูป มีการแสดงชื่อเป็น "Sum of TouristVisits" เนื่องจาก Power BI รวมค่าโดยอัตโนมัติ

### 3. การปรับแต่งเพิ่มเติม

หากต้องการปรับแต่งเพิ่มเติม ให้ทำตามขั้นตอนต่อไปนี้:

1. **เพิ่มป้ายชื่อจังหวัด:**
   * ลาก "Province" ไปยังช่อง "Legend" เพื่อให้จุดมีสีแตกต่างกันตามจังหวัด หรือ
   * ลาก "Province" ไปยังช่อง "Tooltips" เพื่อให้แสดงชื่อจังหวัดเมื่อเลื่อนเมาส์ไปที่จุด

2. **ปรับแต่งรูปแบบ:**
   * คลิกที่ไอคอนรูปแปรงสี (Format) ในแผง Visualizations
   * ในส่วน "Bubbles" คุณสามารถปรับ:
      * ขนาดจุดสูงสุดและต่ำสุด
      * สีของจุด (หากไม่ได้ใช้ Legend)
      * ความโปร่งใส
   * ในส่วน "Map styles" คุณสามารถเปลี่ยนสไตล์ของแผนที่พื้นหลัง
   * ในส่วน "Title" คุณสามารถปรับชื่อของวิชวล (ปัจจุบันเป็น "Sum of TouristVisits by Latitude and Longitude")

3. **การตั้งค่า Tooltips:**
   * ลากฟิลด์เพิ่มเติมเช่น "Population" หรือ "HotelRooms" ไปยังช่อง "Tooltips"
   * คลิกที่ไอคอนรูปแปรงสี > Tooltips เพื่อปรับแต่งรูปแบบ tooltip

4. **การปรับตำแหน่งหรือซูมแผนที่:**
   * ใช้ปุ่ม + และ - ที่มุมบนซ้ายของแผนที่เพื่อซูมเข้าหรือออก
   * ลากแผนที่เพื่อปรับตำแหน่งให้เห็นพื้นที่ที่ต้องการ

### 4. การทำให้แผนที่มีประสิทธิภาพมากขึ้น

1. **ปรับขนาดวิชวล:**
   * ลากมุมของวิชวลเพื่อขยายให้ใหญ่ขึ้น ทำให้เห็นรายละเอียดมากขึ้น

2. **เพิ่ม Slicer สำหรับกรองข้อมูล:**
   * สร้าง Slicer ใหม่จาก visualization pane
   * ลาก "Region" ไปยัง Slicer เพื่อให้ผู้ใช้สามารถกรองดูเฉพาะภูมิภาคที่สนใจ

3. **เพิ่มคำอธิบายเพิ่มเติม:**
   * เพิ่ม Text box เพื่ออธิบายความหมายของขนาดจุด
   * เพิ่ม Card เพื่อแสดงค่ารวมของนักท่องเที่ยวทั้งหมดที่กำลังแสดงอยู่

จากรูปภาพ คุณได้ทำสำเร็จในการแสดงข้อมูลแผนที่จุด (Bubble Map) ของประเทศไทย โดยขนาดจุดแสดงถึงจำนวนนักท่องเที่ยว (TouristVisits) ในแต่ละจังหวัดตามตำแหน่ง Latitude และ Longitude ที่กำหนด
